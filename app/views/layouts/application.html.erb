<!DOCTYPE html>
<html>
<head>
  <title><%= content_for?(:head_title) ? "OSMExtender - #{yield(:head_title)}" : (content_for?(:title) ? "OSMExtender - #{yield(:title)}" : 'OSMExtender') %></title>

  <%= stylesheet_link_tag 'jquery.ui.all' %>
  <%= stylesheet_link_tag 'token-input' %>
  <%= stylesheet_link_tag 'application' %>
  <%= stylesheet_link_tag params[:controller] if OSMExtender::Application.assets.find_asset("#{params[:controller]}.css") %>
  <%= stylesheet_link_tag "#{params[:controller]}__#{params[:action]}" if OSMExtender::Application.assets.find_asset("#{params[:controller]}__#{params[:action]}.css") %>

  <%= javascript_include_tag :jquery  %>
  <%= javascript_include_tag :jquery_ujs %>
  <%= javascript_include_tag 'jquery.ui.all' %>
  <%= javascript_include_tag 'jquery.tokeninput' %>
  <%= javascript_include_tag 'rails.validations' %>
  <%= javascript_include_tag 'rails.validations.custom' %>
  <%= javascript_include_tag 'https://www.google.com/jsapi' if content_for?(:use_charts) %>
  <%= javascript_include_tag 'https://maps.googleapis.com/maps/api/js?sensor=false' if content_for?(:use_maps) %>
  <%= javascript_include_tag 'application' %>
  <%= javascript_include_tag params[:controller] if OSMExtender::Application.assets.find_asset("#{params[:controller]}.js") %>
  <%= javascript_include_tag "#{params[:controller]}__#{params[:action]}" if OSMExtender::Application.assets.find_asset("#{params[:controller]}__#{params[:action]}.js") %>

  <%= csrf_meta_tags %>
</head>
<body>
  <div id="page">
    <div id="header">
      <div id="primary_menu">
        <div id="primary_menu_nav">
          <div class="menu_item"><%= link_to 'Home', root_url %></div>
          <div class="menu_item"><%= link_to 'Help', list_faqs_path %></div>
          <div class="menu_item"><%= link_to 'Contact us', new_contact_u_path %></div>
        </div>
        <div id="primary_menu_user">
          <% if current_user %>
            <div class="menu_item"><%= link_to 'My page', my_page_path %></div>
            <div class="menu_item"><%= link_to 'My account', my_account_path %></div>
            <div class="menu_item"><%= link_to 'Sign out', signout_path %></div>
          <% else %>
            <div class="menu_item"><%= link_to 'Sign up', signup_path %></div>
            <div class="menu_item"><%= link_to 'Sign in', signin_path %></div>
          <% end %>
        </div>
      </div><!-- primary_menu -->

      <div id="banner">
        <%= image_tag 'banner.png', :width => 750, :height => 130, :alt=>'Banner image for OSMExtender' %>
        <div>
          <div style="float: left;">Adding functionallity to the <a href="https://www.onlinescoutmanager.co.uk" target="_blank">Online Scout Manager</a></div>
          <div style="float: right;">Hosted by <a href="https://www.aberdeen-sas.org.uk" target="_blank">Aberdeen Scout Active Support</a></div>
          <div style="clear: both;"></div>
        </div>
      </div><!-- banner -->

      <div id="secondary_menu">
        <%- if current_user && !content_for?(:hide_secondary_menu) %>
          <div id="current_section">
            <%- if current_user.connected_to_osm? && current_role %>
              Current section: <%= current_role.long_name %>
            <%- end %>
          </div>
          <%- if current_user.connected_to_osm? && current_role %>
            <div class="menu_item"><%= link_to 'Email reminders', email_reminders_path %></div>
            <%- if has_osm_permission?(:read, :member) %><div class="menu_item"><%= link_to 'Email lists', email_lists_path %></div><%- end %>
            <%- if !current_section.waiting? && has_osm_permission?(:read, :member) %><div class="menu_item"><%= link_to 'Map members', map_members_path %></div><%- end %>
            <%- if current_section.youth_section? && has_osm_permission?(:read, :programme) %><div class="menu_item"><%= link_to 'Programme review', programme_review_balanced_path %></div><%- end %>
            <%- if current_section.youth_section? && has_osm_permission?(:write, :programme) %><div class="menu_item"><%= link_to 'Programme wizard', new_create_programme_path %></div><%- end %>
            <div class="menu_item"><%= link_to 'OSM permissions', osm_permissions_path %></div>
            <%- unless (current_section.youth_section? && has_osm_permission?(:read, :member) && has_osm_permission?(:write, :programme)) || (!current_section.youth_section? && has_osm_permission?(:read, :member)) %>
              <div style="margin: 0px 10% 0px, 10%; text-align: center; font-weight: bold;">
                <p>Some items have hidden from this menu becuase of how your <%= link_to 'OSM Permissions', osm_permissions_path %> are set.</p>
              </div>
            <%- end %>
          <%- else %>
            <div style="margin-left: 10%; margin-right: 10%; margin-top: auto; margin-bottom: auto; text-align: center; font-weight: bold;">
              <p>Once you have <%= link_to 'connected to OSM', connect_to_osm_path %> links to things you can do will appear here.</p>
            </div>
          <%- end %>
        <%- end %>
      </div><!-- secondary_menu -->

      <%- unless Rails.env.production? %>
        <div style="background-color: <%= {'development'=>'#ff0000', 'staging'=>'#ffff00'}[Rails.env] || '#fa5ffa' %>; color: black; text-align: center; font-size: 200%; height: 1em;">
          <b>This is the <%= Rails.env.upcase %> environment!</b>
        </div>
      <%- end %>

      <%- if flash %>
        <div id="notices">
          <%- if flash[:error] %>
            <div id="notices_error">
              <%= flash[:error] %>
            </div><!-- notices_error -->
          <%- end %>
          <%- if flash[:warning] %>
            <div id="notices_warning">
              <%= flash[:warning] %>
            </div><!-- notices_warning -->
          <%- end %>
          <%- if flash[:notice] %>
            <div id="notices_notice">
              <%= flash[:notice] %>
            </div><!-- notices_notice -->
          <%- end %>
          <%- if flash[:instruction] %>
            <div id="notices_instruction">
              <%= flash[:instruction] %>
            </div><!-- notices_instruction -->
          <%- end %>
        </div><!-- notices -->
      <% end %>
    </div><!-- header -->

    <div id="tertiary_menu">
      <%- if @tertiary_menu_items %>
        <%- @tertiary_menu_items.each do |item| %>
          <div class="menu_item"><%= link_to item[0], item[1] %></div>
        <%- end %>
      <%- end %>
    </div><!-- tertiary_menu -->

  
    <div id="content">
      <%- if content_for?(:title) %>
        <h1><%= yield(:title) %></h1>
      <%- end %>
<%= yield %>
    </div><!-- content -->


  </div><!-- page -->
</body>
</html>
